name = "abide-worker"
main = "index.js"
compatibility_date = "2024-01-01"

[ai]
binding = "AI"

# KV Namespace - create with: wrangler kv:namespace create ABIDE_KV
[[kv_namespaces]]
binding = "ABIDE_KV"
id = "5564c97493b34eaba4eb04d7edbe89b0"

# Cron triggers: check for push notifications every 30 minutes
[triggers]
crons = ["*/30 * * * *"]

# Secrets — set each with: wrangler secret put SECRET_NAME
# (You will be prompted to paste the value securely)
#
# Required for ESV translation:
#   wrangler secret put ESV_API_TOKEN
#   → paste: 92b3774f0e4f96c24bc8398b6b5c1fd93bd0f57d
#
# Required for AI plan builder (Gemini):
#   wrangler secret put GEMINI_API_KEY
#   → paste your Gemini API key
# Optional:
#   wrangler secret put GEMINI_MODEL
#   → e.g. gemini-1.5-flash
#
# Phrase search prefers Cloudflare AI via `env.AI` binding above
# and falls back to Gemini if needed.
#
# Required for devotional web search:
#   wrangler secret put SERPER_API_KEY
#   → paste your Serper.dev key (free tier: 2,500/month)
#
# Required for push notifications:
#   npx web-push generate-vapid-keys   (run this once to get the keys)
#   wrangler secret put VAPID_PUBLIC_KEY
#   wrangler secret put VAPID_PRIVATE_KEY
#   wrangler secret put VAPID_SUBJECT
#   → VAPID_SUBJECT value: mailto:mmac32s1@gmail.com
